#!/bin/bash

# Get the directory where this script is located
SCRIPT_DIR="$(dirname "$0")"

# Initialize counters for passed and failed tests
PASSED_TESTS=0
FAILED_TESTS=0

# Print header
echo "Running unit tests..."
echo "===================="
echo

# Find and execute all test files in the directory
for test_file in "$SCRIPT_DIR"/test-*.sh; do
    # Skip the helper functions file
    if [[ "$test_file" == *"test-helper-functions.sh" ]]; then
        continue
    fi

    echo "üîç $(basename "$test_file")"
    echo "----------------"

    # Execute the test file
    if bash "$test_file"; then
        ((PASSED_TESTS++))
    else
        ((FAILED_TESTS++))
    fi

    echo
done

# Print summary
echo "===================="
echo "Test Results:"
echo "‚úÖ Files passed: $PASSED_TESTS"
echo "‚ùå Files failed: $FAILED_TESTS"
echo "Total files: $((PASSED_TESTS + FAILED_TESTS))"

# Exit with failure if any test file failed
[ $FAILED_TESTS -eq 0 ]